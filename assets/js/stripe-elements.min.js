jQuery(function(a){"use strict";var b,c=Stripe(wc_stripe_params.key),d=c.elements(),e={init:function(){a("form.woocommerce-checkout").length&&(this.form=a("form.woocommerce-checkout")),a("form.woocommerce-checkout").on("checkout_place_order_stripe",this.onSubmit),a("form#order_review").length&&(this.form=a("form#order_review")),a("form#order_review").on("submit",this.onSubmit),a("form#add_payment_method").length&&(this.form=a("form#add_payment_method")),a("form#add_payment_method").on("submit",this.onSubmit),a(document).on("stripeError",this.onError).on("checkout_error",this.clearToken);var c={base:{iconColor:"#666EE8",color:"#31325F",lineHeight:"50px",fontSize:"15px","::placeholder":{color:"#CFD7E0"}}};b=d.create("card",{style:c,hidePostalCode:!0}),b.addEventListener("change",function(b){e.onCCFormChange(),b.error&&a(document.body).trigger("stripeError",b)}),a(document.body).on("updated_checkout",function(){b&&b.unmount("#stripe-card-element"),b.mount("#stripe-card-element")})},isStripeChosen:function(){return a("#payment_method_stripe").is(":checked")&&(!a('input[name="wc-stripe-payment-token"]:checked').length||"new"===a('input[name="wc-stripe-payment-token"]:checked').val())},hasToken:function(){return 0<a("input.stripe_token").length},block:function(){e.form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},unblock:function(){e.form.unblock()},onError:function(b,c){var d=c.error.message;("invalid_request_error"===c.error.type||"api_connection_error"===c.error.type||"api_error"===c.error.type||"authentication_error"===c.error.type||"rate_limit_error"===c.error.type)&&(d=wc_stripe_params.invalid_request_error),"card_error"===c.error.type&&wc_stripe_params.hasOwnProperty(c.error.code)&&(d=wc_stripe_params[c.error.code]),a(".wc-stripe-error, .stripe_token").remove(),a("#stripe-card-errors").html('<ul class="woocommerce_error woocommerce-error wc-stripe-error"><li>'+d+"</li></ul>"),e.unblock()},onSubmit:function(d){return e.isStripeChosen()&&!e.hasToken()?(d.preventDefault(),e.block(),c.createToken(b).then(function(b){b.error?a(document.body).trigger("stripeError",b):"no"===wc_stripe_params.allow_prepaid_card&&"prepaid"===b.token.card.funding?(b.error={message:wc_stripe_params.no_prepaid_card_msg},a(document.body).trigger("stripeError",b)):e.onStripeResponse(b.token)}),!1):void 0},onCCFormChange:function(){a(".wc-stripe-error, .stripe_token").remove()},onStripeResponse:function(a){e.clearToken(),e.form.append("<input type='hidden' class='stripe_token' name='stripe_token' value='"+a.id+"'/>"),e.form.submit()},clearToken:function(){a(".stripe_token").remove()}};e.init()});